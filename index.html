<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <title>Add layers from GitHub repository with Mapbox GL JS</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
    <style>
      body { margin:0; padding:0; }
      #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
  </head>
  <body>
    <div id='map'></div>
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoiZm12YWxkZXpnODQiLCJhIjoiY2w5eWJzMzkwMDNiaDNvbGltamV1ajdvNiJ9.esyugI1HyBVPAQcRN551xw';
      var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        center: [-751405, 39.9839],
        zoom: 13
      });

      var layers = [
        'high_sites',
        'high_sites_props',
        'mesh_nodes',
        'public_spaces',
        'rooftop_hubs',
        'rooftop_hubs_prosp'
      ];

      map.on('load', function() {
        // Add the layers to the map
        for (var i = 0; i < layers.length; i++) {
          var layer = layers[i];
          map.addSource(layer, {
            type: 'geojson',
            data: 'https://raw.githubusercontent.com/fmvaldezg/PCWmap/main/data/' + layer + '.geojson'
          });
          map.addLayer({
            'id': layer,
            'source': layer,
            'type': 'circle',
            'paint': {
              'circle-radius': 10,
              'circle-color': 'red'
            }
          });
        }
      });

    // After the last frame rendered before the map enters an "idle" state.
map.on('idle', () => {
// If these two layers were not added to the map, abort
if (!map.getLayer('high_sites') || !map.getLayer('rooftop_hubs')) {
return;
}
 
// Enumerate ids of the layers.
const toggleableLayerIds = ['high_sites', 'rooftop_hubs'];
 
// Set up the corresponding toggle button for each layer.
for (const id of toggleableLayerIds) {
// Skip layers that already have a button set up.
if (document.getElementById(id)) {
continue;
}
 
// Create a link.
const link = document.createElement('a');
link.id = id;
link.href = '#';
link.textContent = id;
link.className = 'active';
 
// Show or hide layer when the toggle is clicked.
link.onclick = function (e) {
const clickedLayer = this.textContent;
e.preventDefault();
e.stopPropagation();
 
const visibility = map.getLayoutProperty(
clickedLayer,
'visibility'
);
 
// Toggle layer visibility by changing the layout object's visibility property.
if (visibility === 'visible') {
map.setLayoutProperty(clickedLayer, 'visibility', 'none');
this.className = '';
} else {
this.className = 'active';
map.setLayoutProperty(
clickedLayer,
'visibility',
'visible'
);
}
};
 
const layers = document.getElementById('menu');
layers.appendChild(link);
}
});
    </script>
  </body>
</html>